<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Concurs: Posa nom a la IA d'Encamp</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Roboto+Mono:wght@500&display=swap" rel="stylesheet">
<style>
  :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --text-dark: #2d3748;
      --text-light: #718096;
      --bg-color: #f7fafc;
      --card-bg: #ffffff;
      --encamp-blue: #005f85; 
      --disabled-bg: #e2e8f0;
      --disabled-text: #a0aec0;
  }

  body {
      font-family: 'Montserrat', sans-serif;
      background-color: var(--bg-color);
      background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
      background-size: 20px 20px;
      color: var(--text-dark);
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
  }

  /* --- CAP√áALERA I LOGOS --- */
  header {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 50px;
      margin-bottom: 30px;
      flex-wrap: wrap;
      width: 100%;
      max-width: 800px;
  }

  .logo-comu { height: 80px; object-fit: contain; }
  .logo-ia {
      height: 140px; 
      object-fit: contain;
      filter: drop-shadow(0 4px 8px rgba(118, 75, 162, 0.4));
      animation: float 6s ease-in-out infinite;
  }

  @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-12px); }
      100% { transform: translateY(0px); }
  }

  /* --- CONTENIDOR PRINCIPAL --- */
  .main-card {
      background: var(--card-bg);
      width: 100%;
      max-width: 600px;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.1);
      position: relative;
  }

  .main-card::before {
      content: "";
      position: absolute;
      top: 0; left: 0; right: 0; height: 6px;
      background: var(--primary-gradient);
      border-radius: 20px 20px 0 0;
  }

  h1 {
      text-align: center;
      color: var(--encamp-blue);
      margin-bottom: 10px;
      font-weight: 800;
      letter-spacing: -0.5px;
      font-size: 1.8rem;
  }

  p.subtitle {
      text-align: center;
      color: var(--text-light);
      margin-bottom: 30px;
      font-size: 0.95em;
      line-height: 1.5;
  }

  /* --- FORMULARI --- */
  .camp { margin-bottom: 20px; }
  
  label {
      font-size: 0.9em;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 8px;
      display: block;
  }

  input[type="text"], textarea {
      width: 100%;
      padding: 15px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 16px;
      transition: all 0.3s ease;
      box-sizing: border-box;
      font-family: 'Montserrat', sans-serif;
  }

  input:focus, textarea:focus {
      border-color: #764ba2;
      outline: none;
      box-shadow: 0 0 0 3px rgba(118, 75, 162, 0.1);
  }

  textarea#codi_generat {
      background-color: #f8f9fa;
      color: #4a5568;
      font-family: 'Roboto Mono', monospace;
      font-size: 13px;
      resize: none;
      height: 70px;
      border: 1px dashed #cbd5e0;
  }

  /* --- CHECKBOX I BASES --- */
  .bases-container {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 25px;
      font-size: 0.95em;
      background-color: #f8fafc;
      padding: 15px;
      border-radius: 10px;
      border: 1px solid #e2e8f0;
      transition: border-color 0.3s;
  }

  .bases-container:hover {
      border-color: #cbd5e0;
  }

  input[type="checkbox"] {
      width: 22px;
      height: 22px;
      cursor: pointer;
      accent-color: #764ba2;
      margin: 0;
  }

  .btn-bases {
      background: none;
      border: none;
      color: #667eea;
      text-decoration: underline;
      cursor: pointer;
      font-weight: bold;
      font-size: inherit;
      padding: 0;
  }
  .btn-bases:hover { color: #764ba2; }

  /* --- BOT√ì ENVIAR --- */
  button[type="submit"] {
      width: 100%;
      padding: 18px;
      background: var(--primary-gradient);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
  }

  button[type="submit"]:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(118, 75, 162, 0.3);
  }

  /* ESTIL DESACTIVAT (Defecte) */
  button[type="submit"]:disabled {
      background: var(--disabled-bg);
      color: var(--disabled-text);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
      font-size: 16px;
  }

  /* --- POPUP DE LES BASES (MODAL) --- */
  .modal-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      z-index: 9999;
      justify-content: center;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
      backdrop-filter: blur(5px);
  }

  .modal-content {
      background: white;
      width: 100%;
      max-width: 700px;
      max-height: 85vh;
      border-radius: 15px;
      box-shadow: 0 25px 50px rgba(0,0,0,0.25);
      display: flex;
      flex-direction: column;
      position: relative;
      animation: slideIn 0.3s ease;
  }
  
  @keyframes slideIn {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
  }

  .modal-header {
      padding: 20px 25px;
      border-bottom: 1px solid #e2e8f0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #f8fafc;
      border-radius: 15px 15px 0 0;
  }

  .modal-header h2 { margin: 0; font-size: 1.2rem; color: var(--encamp-blue); }

  .close-btn {
      background: none;
      border: none;
      font-size: 28px;
      cursor: pointer;
      color: #718096;
      line-height: 1;
  }

  .modal-body {
      padding: 25px;
      overflow-y: auto;
      font-size: 0.9rem;
      line-height: 1.6;
      text-align: left;
      color: #4a5568;
  }

  .modal-body h3 { color: var(--encamp-blue); margin-top: 25px; border-bottom: 2px solid #edf2f7; padding-bottom: 5px; }
  .modal-body ul { padding-left: 20px; margin-bottom: 15px; }
  .modal-body li { margin-bottom: 8px; }

  /* --- AVISOS --- */
  .avis-box {
      background-color: #fff8e1;
      border-left: 4px solid #ecc94b;
      padding: 15px;
      margin-bottom: 25px;
      border-radius: 6px;
      font-size: 0.85em;
      color: #744210;
      display: flex;
      align-items: center;
      gap: 10px;
      line-height: 1.4;
  }

  .feed-propostes {
      margin-top: 40px;
      text-align: center;
      width: 100%;
      max-width: 600px;
      margin-bottom: 60px;
  }

  #llista-noms {
      font-size: 1.2em;
      color: var(--encamp-blue);
      font-weight: 600;
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
      display: block; 
      word-wrap: break-word;
  }
  
  .separador { color: #cbd5e0; margin: 0 5px; }

  #missatgeEstat {
      text-align: center;
      margin-top: 15px;
      font-weight: bold;
      padding: 15px;
      border-radius: 8px;
  }

  /* Mobile tweaks */
  @media (max-width: 480px) {
      header { gap: 20px; flex-direction: row; }
      .logo-comu { height: 50px; }
      .logo-ia { height: 90px; }
      .main-card { padding: 25px; }
      h1 { font-size: 1.5em; }
      .modal-content { max-height: 90vh; width: 95%; margin: auto; }
      .bases-container { flex-direction: row; align-items: flex-start; }
      input[type="checkbox"] { margin-top: 2px; flex-shrink: 0; }
  }
</style>
</head>
<body>

  <header>
      <img src="logoCE.png" alt="Com√∫ d'Encamp" class="logo-comu">
      <img src="logoIA.png" alt="Logo IA" class="logo-ia">
  </header>

  <div class="main-card">
      <h1>Posa nom a la IA</h1>
      <p class="subtitle">Ajuda'ns a batejar la intel¬∑lig√®ncia artificial del Com√∫. <br>La teva proposta quedar√† registrada i segellada.</p>

      <div class="avis-box">
          <span>üì∏ <strong>Recorda:</strong> Fes una captura de pantalla abans de sortir. Aquest ser√† el teu justificant de participaci√≥.</span>
      </div>

      <form id="formIA">
          <div class="camp">
              <label for="nom_ia">La teva proposta de nom (M√†x 15 car√†cters)</label>
              <input type="text" id="nom_ia" name="nom_ia" placeholder="Ex: EncampBot, Valira..." required autocomplete="off" maxlength="15">
          </div>

          <div class="camp">
              <label for="input_password">Contrasenya privada (per generar el codi)</label>
              <input type="text" id="input_password" name="input_password" placeholder="Escriu una paraula clau..." required autocomplete="off">
          </div>

          <div class="camp">
              <label for="codi_generat">Codi de seguretat √∫nic (Hash SHA-256)</label>
              <textarea id="codi_generat" name="codi_generat" readonly placeholder="El codi apareixer√† aqu√≠ autom√†ticament..."></textarea>
          </div>

          <div class="bases-container">
              <input type="checkbox" id="accepto_bases" name="accepto_bases">
              <label for="accepto_bases">
                  He llegit i accepto les <button type="button" class="btn-bases" onclick="obrirModal()">bases del concurs</button>.
              </label>
          </div>

          <button type="submit" id="btnEnviar" disabled>‚ö†Ô∏è Primer has d'acceptar les bases</button>
          
          <div id="missatgeEstat" style="display:none;"></div>
      </form>
  </div>

  <div class="feed-propostes">
      <div style="font-size: 0.8em; text-transform: uppercase; color: #a0aec0; letter-spacing: 2px; margin-bottom: 10px; font-weight: 700;">Propostes destacades</div>
      <div id="llista-noms">
          <span style="color: #cbd5e0; font-size: 0.8em;">Carregant propostes...</span>
      </div>
  </div>

  <div id="modalBases" class="modal-overlay" onclick="tancarModal(event)">
      <div class="modal-content">
          <div class="modal-header">
              <h2>Bases del Concurs</h2>
              <button class="close-btn" onclick="tancarModalBoto()">&times;</button>
          </div>
          <div class="modal-body">
              <p><strong>BASES DEL CONCURS D'IDEES PER A LA DENOMINACI√ì DE LA PLATAFORMA D'INTEL¬∑LIG√àNCIA ARTIFICIAL DEL COM√ö D'ENCAMP</strong></p>
              
              <h3>1. OBJECTE DEL CONCURS</h3>
              <p>El Com√∫ d'Encamp convoca un concurs d'idees intern amb l'objectiu de trobar un nom original, representatiu i amb sonoritat catalana per a la nova plataforma d'Intel¬∑lig√®ncia Artificial de la corporaci√≥.</p>

              <h3>2. PARTICIPANTS</h3>
              <ul>
                  <li>El concurs √©s obert exclusivament a <strong>persones f√≠siques</strong> que mantinguin una relaci√≥ laboral activa amb el Com√∫ d'Encamp i disposin de n√∫mero de personal assignat.</li>
                  <li>La participaci√≥ √©s <strong>individual</strong>.</li>
              </ul>

              <h3>3. REQUISITS DE LES PROPOSTES (NOMS)</h3>
              <ul>
                  <li><strong>Longitud:</strong> No podran excedir els <strong>15 car√†cters</strong> (espais inclosos).</li>
                  <li><strong>Contingut:</strong> Quedaran autom√†ticament desqualificats els noms que continguin insults, paraules grolleres, discriminat√≤ries o que atemptin contra la imatge del Com√∫.</li>
                  <li><strong>Llengua:</strong> Es valorar√† positivament que el nom tingui <strong>sonoritat catalana</strong>.</li>
                  <li><strong>Originalitat i Registre:</strong> El nom no pot estar registrat pr√®viament com a marca comercial. Si es detecta que el nom ja t√© drets d'autor vigents per tercers, ser√† desqualificat.</li>
                  <li><strong>Unicitat:</strong> No s'acceptaran noms repetits dins del concurs. En cas de duplicitats, prevaldr√† la proposta que hagi entrat primer al sistema (data i hora del registre).</li>
              </ul>

              <h3>4. MEC√ÄNICA DE PARTICIPACI√ì I ANONIMAT</h3>
              <p>Per tal de garantir la imparcialitat en la selecci√≥ inicial, el proc√©s ser√† an√≤nim fins al moment de l'adjudicaci√≥ del premi.</p>
              <ul>
                  <li><strong>Enviament:</strong> Les propostes s'enviaran a trav√©s de la p√†gina habilitada a la Intranet del Com√∫.</li>
                  <li><strong>Sistema de Seguretat (HASH):</strong> 
                      <br>- El participant introduir√† el Nom Proposat i una Contrasenya personal (aquesta contrasenya NO s'envia al servidor).
                      <br>- El sistema generar√† autom√†ticament un codi xifrat √∫nic (SHA-256) a partir de la contrasenya.
                      <br>- El formulari enviar√† √∫nicament: El Nom Proposat + El Codi SHA-256.
                  </li>
                  <li><strong>Responsabilitat del participant:</strong>
                      <br>- √âs <strong>obligatori</strong> que el participant faci una captura de pantalla o guardi la contrasenya utilitzada.
                      <br>- El Com√∫ d'Encamp no t√© acc√©s a la contrasenya. Si el participant la perd, no podr√† demostrar l'autoria del nom i perdr√† el dret al premi.
                  </li>
              </ul>

              <h3>5. PUBLICITAT DE LES PROPOSTES</h3>
              <p>Di√†riament, s'actualitzar√† a la Intranet un llistat p√∫blic amb els noms rebuts i acceptats, per tal que els participants puguin verificar que la seva proposta ha estat registrada i que no hi hagi duplicitats futures.</p>

              <h3>6. CALENDARI</h3>
              <ul>
                  <li><strong>Inici de propostes:</strong> 28 de novembre de 2025.</li>
                  <li><strong>Tancament de propostes:</strong> 05 de desembre de 2025 (a les 23:59h).</li>
                  <li><strong>Selecci√≥ dels finalistes (Directors):</strong> 09 de desembre de 2025.</li>
                  <li><strong>Votaci√≥ popular (Treballadors):</strong> Del 10 al 17 de desembre de 2025 (tancament a les 12:00h).</li>
                  <li><strong>Anunci del guanyador:</strong> 18 de desembre de 2025 (Sopar de Nadal).</li>
              </ul>

              <h3>7. SISTEMA DE JURAT I VOTACI√ì</h3>
              <p>El proc√©s de selecci√≥ constar√† de dues fases:</p>
              <ul>
                  <li><strong>Fase 1: Selecci√≥ T√®cnica.</strong> Un jurat format pels Directors del Com√∫ d'Encamp avaluar√† totes les propostes v√†lides el dia 9 de desembre de 2025. Seleccionaran els 10 millors noms.</li>
                  <li><strong>Fase 2: Votaci√≥ Popular.</strong> Els 10 noms finalistes se sotmetran a votaci√≥ de tots els treballadors del Com√∫ mitjan√ßant un formulari de Microsoft Forms. El nom m√©s votat ser√† el guanyador.</li>
              </ul>

              <h3>8. PREMI I LLIURAMENT</h3>
              <ul>
                  <li>S'estableix un √∫nic premi consistent en un <strong>iPhone 17 Pro</strong>.</li>
                  <li>El guanyador/a es donar√† a con√®ixer durant el Sopar de Nadal del Com√∫ d'Encamp, el dia 18 de desembre de 2025.</li>
                  <li><strong>Reclamaci√≥ del premi:</strong> Durant l'acte, l'autor haur√† d'identificar-se i facilitar la contrasenya utilitzada en el registre per verificar el codi SHA-256. Si no pot acreditar la contrasenya, el premi passar√† a la segona proposta m√©s votada.</li>
              </ul>

              <h3>9. PROPIETAT INTEL¬∑LECTUAL</h3>
              <ul>
                  <li>La participaci√≥ en el concurs implica l'acceptaci√≥ d'aquestes bases.</li>
                  <li>Tot i que es reconeixer√† p√∫blicament l'autoria, <strong>la propietat intel¬∑lectual, els drets d'explotaci√≥ i l'√∫s del nom passaran a ser propietat exclusiva del Com√∫ d'Encamp</strong>, que podr√† registrar-lo o modificar-lo sense cap contraprestaci√≥ addicional al premi lliurat.</li>
              </ul>
          </div>
      </div>
  </div>

<script>
  // URL del Power Automate
  const ENDPOINT_URL = "https://default3913d1da1a21459da5e88b165cdb91.34.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/04e21528bbad48038b04aeefb0060abd/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=7r-gwYSwI7QTSj_hs5QexySI_q36US3dLXtrrH758rg"; 

  // --- CONTROL DEL BOT√ì ENVIAR ---
  const checkBases = document.getElementById('accepto_bases');
  const btnEnviar = document.getElementById('btnEnviar');

  checkBases.addEventListener('change', function() {
      if (this.checked) {
          // Si marca la casella: ACTIVEJO EL BOT√ì
          btnEnviar.disabled = false;
          btnEnviar.innerText = "ENVIAR PROPOSTA";
      } else {
          // Si desmarca: BLOQUEJO EL BOT√ì
          btnEnviar.disabled = true;
          btnEnviar.innerText = "‚ö†Ô∏è Primer has d'acceptar les bases";
      }
  });

  // --- CONTROL DEL MODAL (POPUP) ---
  function obrirModal() {
      document.getElementById('modalBases').style.display = 'flex';
      document.body.style.overflow = 'hidden'; 
  }

  function tancarModalBoto() {
      document.getElementById('modalBases').style.display = 'none';
      document.body.style.overflow = 'auto';
  }

  function tancarModal(e) {
      if (e.target.id === 'modalBases') {
          tancarModalBoto();
      }
  }

  // --- C√ÄRREGA DE NOMS VALIDATS ---
  document.addEventListener("DOMContentLoaded", function() {
      fetch('nomsok.html')
          .then(response => {
              if (!response.ok) throw new Error("No s'ha trobat l'arxiu");
              return response.text();
          })
          .then(html => {
              const llista = document.getElementById('llista-noms');
              if (html.trim().length > 0) llista.innerHTML = html;
              else llista.innerHTML = '<span style="color: #cbd5e0;">Encara no hi ha propostes validades.</span>';
          })
          .catch(err => {
              console.log("Info: executant sense servidor o sense fitxer.", err);
              document.getElementById('llista-noms').innerHTML = '<span style="color: #cbd5e0;">Propostes pendents de validaci√≥.</span>';
          });
  });

  // --- Generaci√≥ autom√†tica del Hash ---
  async function actualitzarHash() {
    const text = document.getElementById('input_password').value;
    const outputCamp = document.getElementById('codi_generat');

    if (text === "") { outputCamp.value = ""; return; }

    const encoder = new TextEncoder();
    const data = encoder.encode(text);
    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    
    outputCamp.value = hashHex;
  }

  document.getElementById('input_password').addEventListener('input', actualitzarHash);

  // --- Gesti√≥ d'Enviament ---
  document.getElementById('formIA').addEventListener('submit', function(e) {
    e.preventDefault(); 

    const boto = document.getElementById('btnEnviar');
    const missatge = document.getElementById('missatgeEstat');
    const nomProposat = document.getElementById('nom_ia').value;
    const codiFinal = document.getElementById('codi_generat').value;

    // La validaci√≥ del checkbox ja la fa el navegador (required) i l'estat disabled del bot√≥,
    // per√≤ per seguretat extra la mantenim:
    if(!checkBases.checked) {
        alert("Has d'acceptar les bases.");
        return;
    }

    if(!codiFinal) {
        alert("Si us plau, escriu una contrasenya per generar el codi segur.");
        return;
    }

    // Enviant...
    boto.disabled = true;
    boto.innerHTML = '<span style="display:inline-block; animation: spin 1s linear infinite;">‚è≥</span> Enviant...';
    missatge.style.display = "none";

    const dades = {
      nom_ia: nomProposat,
      codi_usuari: codiFinal 
    };

    fetch(ENDPOINT_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(dades)
    })
    .then(response => {
      if (response.ok) {
        missatge.innerHTML = "‚úÖ Proposta registrada correctament!";
        missatge.style.display = "block";
        missatge.style.color = "#276749";
        missatge.style.backgroundColor = "#C6F6D5";
        
        boto.innerText = "ENVIAT (Fes captura ara)";
        boto.style.background = "#48BB78";
      } else {
        throw new Error('Error del servidor');
      }
    })
    .catch(error => {
      console.error(error);
      missatge.innerText = "‚ùå Error de connexi√≥. Torna-ho a provar.";
      missatge.style.display = "block";
      missatge.style.color = "#9B2C2C";
      missatge.style.backgroundColor = "#FED7D7";
      
      boto.disabled = false;
      boto.innerText = "Tornar a intentar";
    });
  });
</script>

</body>
</html>